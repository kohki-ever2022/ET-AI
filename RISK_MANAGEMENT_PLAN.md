# ET-AI リスク管理計画

**プロジェクト名**: ET-AI (Ethics & Transparency Engine)
**バージョン**: 1.0
**最終更新**: 2025年11月
**責任者**: プロジェクトマネージャー

## 目次

1. [エグゼクティブサマリー](#エグゼクティブサマリー)
2. [リスク管理の目的と範囲](#リスク管理の目的と範囲)
3. [リスク評価基準](#リスク評価基準)
4. [リスクカテゴリー別詳細](#リスクカテゴリー別詳細)
5. [リスクマトリックス](#リスクマトリックス)
6. [緊急対応プラン](#緊急対応プラン)
7. [月次リスクレビュー手順](#月次リスクレビュー手順)
8. [付録](#付録)

---

## エグゼクティブサマリー

ET-AIプロジェクトは、Claude APIとVoyage AIを活用した企業向けナレッジ管理システムです。本リスク管理計画は、プロジェクトの成功を脅かす可能性のあるリスクを特定し、軽減策を提供します。

### 主要リスク（トップ5）

| # | リスク | カテゴリー | スコア | 対策状況 |
|---|--------|-----------|--------|---------|
| 1 | Claude APIレート制限超過 | 技術 | 高×高=9 | 対策済 |
| 2 | API価格の大幅な変動 | 外部依存 | 中×高=6 | 監視中 |
| 3 | 大量データによるパフォーマンス劣化 | 技術 | 中×中=4 | 対策済 |
| 4 | 予算超過による機能追加制限 | スコープ | 中×中=4 | 監視中 |
| 5 | プライバシー規制の変更 | 外部依存 | 低×高=3 | 監視中 |

### リスク管理体制

- **リスクオーナー**: プロジェクトマネージャー
- **技術リスク責任者**: テックリード
- **セキュリティ責任者**: セキュリティエンジニア
- **レビュー頻度**: 月次（第1金曜日）

---

## リスク管理の目的と範囲

### 目的

1. プロジェクトの成功を脅かすリスクを早期に特定する
2. リスクの影響を最小化するための予防策を実施する
3. リスク発生時の迅速な対応を可能にする
4. ステークホルダーへの透明性のある報告を行う

### 範囲

本リスク管理計画は、以下を対象とします：

- **開発フェーズ**: 設計、実装、テスト、デプロイ
- **運用フェーズ**: 本番運用、保守、拡張
- **組織範囲**: 開発チーム、運用チーム、経営陣
- **技術範囲**: フロントエンド、バックエンド、インフラ、外部API

対象外：
- プロジェクト外部の経営リスク
- 市場リスク（競合分析など）

---

## リスク評価基準

### 発生確率の定義

| レベル | 確率 | 定義 |
|-------|------|------|
| **高** | 50%以上 | ほぼ確実に発生する、または既に兆候がある |
| **中** | 20-49% | 発生する可能性がある |
| **低** | 20%未満 | 発生する可能性は低いが、無視できない |

### 影響度の定義

| レベル | 影響 | 定義 |
|-------|------|------|
| **高** | 致命的 | プロジェクトの継続が困難、または重大な損失 |
| **中** | 重大 | プロジェクトの遅延や品質低下、予算超過 |
| **低** | 軽微 | 限定的な影響、容易に回復可能 |

### リスクスコア計算

リスクスコアは以下の式で計算されます：

```
リスクスコア = 発生確率レベル × 影響度レベル

レベル値:
- 高 = 3
- 中 = 2
- 低 = 1

例：
発生確率「高(3)」× 影響度「高(3)」= リスクスコア 9 (最高)
発生確率「低(1)」× 影響度「低(1)」= リスクスコア 1 (最低)
```

### リスク対応の優先度

| スコア | 優先度 | 対応方針 |
|--------|--------|---------|
| 6-9 | 最優先 | 即座に対策を実施、週次でモニタリング |
| 3-5 | 高 | 計画的に対策を実施、月次でモニタリング |
| 1-2 | 中 | 監視を継続、必要に応じて対策 |

---

## リスクカテゴリー別詳細

## 1. 技術リスク

### 1.1 Claude APIレート制限超過

**リスク内容**:
Claude APIの利用量が急増し、レート制限（RPM、TPM）を超過する。これにより、ユーザーへのレスポンスが遅延または失敗する。

**発生確率**: **高** (50%以上)
**影響度**: **高** (致命的)
**リスクスコア**: **9** (最優先)

**発生シナリオ**:
- 同時ユーザー数が想定（50人）を超える
- 大量のバッチ処理が通常業務時間と重複
- 予期しないスパイクトラフィック

**予防策**:
1. ✅ **実装済**: キューイングシステム (p-queue) による同時実行数制御
2. ✅ **実装済**: レート制限監視とアラート (`rateLimitMonitor.ts`)
3. ✅ **実装済**: バッチ処理のスケジューリング（深夜2時実行）
4. **計画中**: 段階的スケールアップ（ユーザー数に応じてティア変更）
5. **推奨**: Anthropic社への事前通知（大規模イベント前）

**発生時の対応策**:
1. **即時対応（5分以内）**:
   - キューサイズの監視とアラート通知
   - 自動リトライ（exponential backoff）の発動
   - エラーログの収集

2. **短期対応（30分以内）**:
   - バッチ処理の一時停止
   - 優先度の低いリクエストの遅延
   - ユーザーへの状況通知

3. **中期対応（1時間以内）**:
   - Anthropic社へのティアアップグレード申請
   - キャッシュ戦略の最適化
   - 負荷分散の調整

**責任者**:
- **技術責任者**: テックリード
- **監視責任者**: DevOpsエンジニア
- **エスカレーション先**: プロジェクトマネージャー

**モニタリング指標**:
- RPM使用率 (目標: <80%)
- TPM使用率 (目標: <80%)
- キュー待ち時間 (目標: <5秒)
- エラー率 (目標: <1%)

---

### 1.2 Voyage AI エンベディングAPIの不安定性

**リスク内容**:
Voyage AIのエンベディング生成APIが不安定になり、ベクトル検索機能が利用できなくなる。

**発生確率**: **中** (20-49%)
**影響度**: **中** (重大)
**リスクスコア**: **4** (高)

**発生シナリオ**:
- Voyage AIのサービス障害
- ネットワーク遅延による タイムアウト
- API仕様変更による互換性問題

**予防策**:
1. ✅ **実装済**: リトライ戦略（3回まで、exponential backoff）
2. ✅ **実装済**: タイムアウト設定（30秒）
3. **推奨**: 代替エンベディングサービスの検討（OpenAI Embeddings）
4. **推奨**: エンベディングキャッシュの実装
5. **推奨**: Voyage AI のステータスページ監視

**発生時の対応策**:
1. **即時対応**:
   - エラーログの確認
   - Voyage AI ステータスページの確認
   - 一時的なフォールバック（キーワード検索）

2. **短期対応**:
   - Voyage AI サポートへの問い合わせ
   - 既存のエンベディングキャッシュの活用
   - ユーザーへの代替機能の案内

3. **長期対応**:
   - 代替サービスへの切り替え準備
   - マルチベンダー戦略の検討

**責任者**: バックエンドエンジニア

---

### 1.3 Firestoreのパフォーマンス劣化

**リスク内容**:
データ量の増加に伴い、Firestoreクエリのパフォーマンスが劣化し、ユーザー体験が低下する。

**発生確率**: **中** (20-49%)
**影響度**: **中** (重大)
**リスクスコア**: **4** (高)

**発生シナリオ**:
- ナレッジベースのサイズが100万件を超える
- インデックスの不足または不適切な設計
- 複雑なクエリによる読み取り操作の増加

**予防策**:
1. ✅ **実装済**: 包括的なFirestoreインデックス設計
2. ✅ **実装済**: 非正規化によるリード削減
3. ✅ **実装済**: アーカイブシステム（90日未使用データ）
4. ✅ **実装済**: ページネーション（50件/ページ）
5. **推奨**: パフォーマンス監視ダッシュボード
6. **推奨**: 定期的なクエリ最適化レビュー

**発生時の対応策**:
1. **即時対応**:
   - スロークエリの特定（Cloud Monitoring）
   - 一時的なキャッシュの強化

2. **中期対応**:
   - インデックスの追加または再設計
   - クエリの最適化
   - データのパーティショニング

3. **長期対応**:
   - データベースアーキテクチャの見直し
   - BigQueryへのコールドデータ移行

**責任者**: データベーススペシャリスト

**モニタリング指標**:
- クエリレイテンシ (目標: p95 < 500ms)
- 読み取り操作数 (予算内)
- インデックスヒット率 (目標: >95%)

---

### 1.4 Cloud Functionsのコールドスタート問題

**リスク内容**:
Cloud Functionsのコールドスタートにより、初回リクエストのレスポンスが遅延する。

**発生確率**: **中** (20-49%)
**影響度**: **低** (軽微)
**リスクスコア**: **2** (中)

**発生シナリオ**:
- トラフィックが低い時間帯（深夜）
- 新しいインスタンスのスケールアウト時
- デプロイ直後

**予防策**:
1. ✅ **実装済**: minInstances設定（主要機能は2以上）
2. **推奨**: Warmupリクエストの定期実行
3. **推奨**: 初期化処理の最適化

**発生時の対応策**:
1. ユーザーへの待機表示
2. minInstancesの調整
3. Cloud Run への移行検討（長期）

**責任者**: インフラエンジニア

---

### 1.5 フロントエンドのバンドルサイズ肥大化

**リスク内容**:
依存ライブラリの増加により、フロントエンドのバンドルサイズが肥大化し、初期ロード時間が増加する。

**発生確率**: **中** (20-49%)
**影響度**: **中** (重大)
**リスクスコア**: **4** (高)

**発生シナリオ**:
- 新機能追加による依存ライブラリの増加
- 大きなUIライブラリの導入
- Tree-shakingの不適切な設定

**予防策**:
1. **実施中**: バンドルサイズの定期チェック
2. **推奨**: コードスプリッティングの活用
3. **推奨**: lazy loading の実装
4. **推奨**: 依存ライブラリの定期レビュー
5. **推奨**: Lighthouse CI の導入

**発生時の対応策**:
1. バンドルアナライザーで原因特定
2. 不要な依存関係の削除
3. 動的インポートへの切り替え
4. CDN最適化

**責任者**: フロントエンドエンジニア

**モニタリング指標**:
- バンドルサイズ (目標: <500KB)
- 初期ロード時間 (目標: <3秒)
- Lighthouse スコア (目標: >90)

---

## 2. スコープリスク

### 2.1 機能追加要望の増加

**リスク内容**:
ユーザーやステークホルダーからの機能追加要望が増加し、プロジェクトスコープが拡大する。

**発生確率**: **高** (50%以上)
**影響度**: **中** (重大)
**リスクスコア**: **6** (最優先)

**発生シナリオ**:
- ユーザーからの新機能リクエスト
- 競合製品の機能に対する対抗
- 経営層からの追加要求

**予防策**:
1. **実施中**: スコープ管理プロセスの確立
2. **推奨**: 変更管理委員会の設置
3. **推奨**: ロードマップの明確化（フェーズ分け）
4. **推奨**: 機能優先度マトリックスの活用
5. **推奨**: MVP（Minimum Viable Product）の定義

**発生時の対応策**:
1. **評価フェーズ（1週間）**:
   - 要望の詳細ヒアリング
   - 影響分析（工数、コスト、リスク）
   - 優先度評価

2. **意思決定フェーズ**:
   - 変更管理委員会での審議
   - 承認/延期/却下の決定
   - ステークホルダーへの通知

3. **実装フェーズ（承認時）**:
   - スケジュール調整
   - リソース配分
   - リスク再評価

**責任者**: プロジェクトマネージャー

**管理指標**:
- 機能追加要望数/月 (目標: <5件)
- 承認率 (目標: <30%)
- スコープクリープ率 (目標: <10%)

---

### 2.2 仕様変更による手戻り

**リスク内容**:
要件や仕様の変更により、既存の実装を大幅に修正する必要が生じる。

**発生確率**: **中** (20-49%)
**影響度**: **中** (重大)
**リスクスコア**: **4** (高)

**発生シナリオ**:
- ユーザー要件の誤解
- 技術的な制約の後発的な発見
- 法規制の変更

**予防策**:
1. **実施中**: 詳細な要件定義と確認プロセス
2. **推奨**: プロトタイピングによる早期検証
3. **推奨**: ユーザー受け入れテスト（UAT）の実施
4. **推奨**: 変更影響分析の実施

**発生時の対応策**:
1. 影響範囲の特定
2. 代替案の検討
3. 段階的な移行計画の策定
4. テスト計画の更新

**責任者**: プロジェクトマネージャー、テックリード

---

### 2.3 パフォーマンス要件の変更

**リスク内容**:
当初想定していたパフォーマンス要件（ユーザー数、データ量、レスポンス時間）が変更される。

**発生確率**: **中** (20-49%)
**影響度**: **高** (致命的)
**リスクスコア**: **6** (最優先)

**発生シナリオ**:
- ユーザー数の急増（50人→500人）
- データ量の爆発的な増加
- SLA要件の厳格化

**予防策**:
1. ✅ **実装済**: スケーラブルなアーキテクチャ設計
2. **推奨**: 定期的な負荷テスト
3. **推奨**: キャパシティプランニング
4. **推奨**: パフォーマンス予算の設定

**発生時の対応策**:
1. **短期対応**:
   - インフラのスケールアップ
   - キャッシュの強化
   - 不要な機能の無効化

2. **中長期対応**:
   - アーキテクチャの再設計
   - 段階的な最適化
   - コスト再計算

**責任者**: アーキテクト、インフラエンジニア

---

## 3. 人的リスク

### 3.1 キーパーソンの離脱

**リスク内容**:
プロジェクトの中核メンバー（テックリード、アーキテクトなど）が離脱し、知識が失われる。

**発生確率**: **低** (20%未満)
**影響度**: **高** (致命的)
**リスクスコア**: **3** (高)

**発生シナリオ**:
- 突然の退職
- 長期休暇や病欠
- 他プロジェクトへの異動

**予防策**:
1. **実施中**: ドキュメント化の徹底
   - アーキテクチャ設計書
   - セットアップガイド
   - トラブルシューティングガイド
2. **推奨**: ナレッジ共有セッション（週次）
3. **推奨**: ペアプログラミング/コードレビューの実施
4. **推奨**: バックアップ担当者の育成
5. **推奨**: クリティカルパスの可視化

**発生時の対応策**:
1. **即時対応（1週間）**:
   - 知識移転セッションの実施
   - ドキュメントの棚卸し
   - 引き継ぎ事項のリスト化

2. **短期対応（1ヶ月）**:
   - 後任者の選定
   - 外部コンサルタントの活用
   - プロジェクトスケジュールの見直し

3. **中長期対応**:
   - チーム体制の再構築
   - 知識管理プロセスの強化

**責任者**: プロジェクトマネージャー、人事

---

### 3.2 スキル不足

**リスク内容**:
チームメンバーが必要な技術スキル（Claude API、Firebase、TypeScriptなど）を十分に持っていない。

**発生確率**: **中** (20-49%)
**影響度**: **中** (重大)
**リスクスコア**: **4** (高)

**発生シナリオ**:
- 新しい技術スタックの導入
- 経験の浅いメンバーの参画
- 技術トレンドの急速な変化

**予防策**:
1. **実施中**: オンボーディングプログラムの整備
2. **推奨**: 定期的なトレーニング（月1回）
3. **推奨**: 技術書の購入支援
4. **推奨**: カンファレンス参加の奨励
5. **推奨**: 社内勉強会の開催

**発生時の対応策**:
1. スキルギャップの特定
2. メンタリングプログラムの実施
3. 外部トレーニングの受講
4. 外部専門家の一時的な招聘

**責任者**: テックリード、人事

**モニタリング指標**:
- スキルアセスメントスコア
- トレーニング参加率
- コードレビュー品質

---

### 3.3 チーム間のコミュニケーション不足

**リスク内容**:
フロントエンド、バックエンド、インフラチーム間のコミュニケーション不足により、統合時に問題が発生する。

**発生確率**: **中** (20-49%)
**影響度**: **中** (重大)
**リスクスコア**: **4** (高)

**発生シナリオ**:
- リモートワークによる対面機会の減少
- タイムゾーンの違い
- 役割分担の不明確さ

**予防策**:
1. **実施中**: 定期的なスタンドアップミーティング（日次）
2. **推奨**: スプリントレビュー（2週間ごと）
3. **推奨**: API仕様書の共有と合意
4. **推奨**: Slackチャンネルの活用
5. **推奨**: 統合テストの早期実施

**発生時の対応策**:
1. 問題の早期発見と共有
2. 緊急ミーティングの招集
3. コミュニケーションプロトコルの見直し

**責任者**: プロジェクトマネージャー

---

## 4. 外部依存リスク

### 4.1 Claude API価格の大幅な変動

**リスク内容**:
Anthropic社がClaude APIの価格を大幅に値上げし、運用コストが予算を超過する。

**発生確率**: **中** (20-49%)
**影響度**: **高** (致命的)
**リスクスコア**: **6** (最優先)

**発生シナリオ**:
- Anthropic社の価格改定
- 使用量の急増による上位ティアへの移行
- 為替レートの変動（USD/JPY）

**予防策**:
1. ✅ **実装済**: コスト監視システム
   - リアルタイムコスト追跡
   - 予算アラート
   - 使用量ダッシュボード
2. ✅ **実装済**: プロンプトキャッシング（最大90%コスト削減）
3. **推奨**: 長期契約による価格固定の検討
4. **推奨**: 代替AI サービスの調査（フォールバック）
5. **推奨**: コスト最適化戦略の定期見直し

**発生時の対応策**:
1. **短期対応（1週間）**:
   - 現在のコスト分析
   - 緊急予算会議の開催
   - 一時的な使用量制限

2. **中期対応（1ヶ月）**:
   - 価格交渉（Anthropic社）
   - プロンプト最適化によるトークン削減
   - 不要な機能の無効化

3. **長期対応（3ヶ月）**:
   - 代替AIモデルへの部分移行
   - 料金プランの見直し
   - ビジネスモデルの調整（ユーザー課金）

**責任者**: プロジェクトマネージャー、財務

**モニタリング指標**:
- 月間API費用 (目標: 予算内)
- コスト per ユーザー
- トークン使用効率

---

### 4.2 Anthropic社のサービス仕様変更

**リスク内容**:
Claude APIの仕様変更（モデルの廃止、パラメータ変更、Breaking Changes）により、既存実装が動作しなくなる。

**発生確率**: **中** (20-49%)
**影響度**: **高** (致命的)
**リスクスコア**: **6** (最優先)

**発生シナリオ**:
- Claude 3.5 Sonnetの廃止
- APIエンドポイントの変更
- レスポンス形式の変更

**予防策**:
1. **実施中**: SDKバージョンの固定（package.json）
2. **推奨**: Anthropic社のアナウンスメント監視
3. **推奨**: 段階的なSDKアップグレード
4. **推奨**: 統合テストの自動化
5. **推奨**: 複数モデルのサポート

**発生時の対応策**:
1. **即時対応**:
   - エラーログの確認
   - Anthropic社のドキュメント確認
   - 一時的なロールバック

2. **短期対応**:
   - コードの修正と テスト
   - 段階的なデプロイ
   - ユーザーへの影響確認

3. **長期対応**:
   - 抽象化レイヤーの導入
   - マルチプロバイダー戦略

**責任者**: バックエンドエンジニア

---

### 4.3 GDPRやプライバシー規制の変更

**リスク内容**:
プライバシー規制（GDPR、個人情報保護法など）の変更により、データ処理方法の変更が必要になる。

**発生確率**: **低** (20%未満)
**影響度**: **高** (致命的)
**リスクスコア**: **3** (高)

**発生シナリオ**:
- EU GDPR の改正
- 日本の個人情報保護法の改正
- 新しいAI規制の導入

**予防策**:
1. **実施中**: プライバシーバイデザインの実装
2. **推奨**: 法務チームとの定期レビュー（四半期ごと）
3. **推奨**: データ保護影響評価（DPIA）の実施
4. **推奨**: ユーザー同意管理の実装
5. **推奨**: データ最小化原則の遵守

**発生時の対応策**:
1. 法務チームとの緊急協議
2. 規制内容の詳細分析
3. 対応計画の策定
4. 段階的な実装
5. コンプライアンス監査

**責任者**: 法務、セキュリティ責任者

---

### 4.4 Firebaseの価格改定

**リスク内容**:
Google CloudがFirebaseの価格を改定し、FirestoreやCloud Functionsのコストが増加する。

**発生確率**: **低** (20%未満)
**影響度**: **中** (重大)
**リスクスコア**: **2** (中)

**発生シナリオ**:
- Google Cloudの価格改定
- 使用量の増加によるティア変更

**予防策**:
1. ✅ **実装済**: Firestoreリード削減戦略
2. ✅ **実装済**: 非正規化によるクエリ最適化
3. ✅ **実装済**: アーカイブシステム
4. **推奨**: BigQueryへのコールドデータ移行
5. **推奨**: 代替データベースの調査

**発生時の対応策**:
1. コスト分析
2. 最適化の実施
3. 段階的な移行計画

**責任者**: インフラエンジニア、財務

---

### 4.5 npm パッケージの脆弱性

**リスク内容**:
依存しているnpmパッケージに重大な脆弱性が発見され、セキュリティリスクが生じる。

**発生確率**: **中** (20-49%)
**影響度**: **高** (致命的)
**リスクスコア**: **6** (最優先)

**発生シナリオ**:
- 依存パッケージの脆弱性公開
- サプライチェーン攻撃
- メンテナンスされていないパッケージの使用

**予防策**:
1. **推奨**: Dependabotの有効化
2. **推奨**: 定期的な依存関係監査（週次）
3. **推奨**: npm audit の自動実行（CI/CD）
4. **推奨**: パッケージの最小化
5. **推奨**: 信頼できるパッケージのみ使用

**発生時の対応策**:
1. **即時対応（24時間以内）**:
   - 脆弱性の詳細確認
   - 影響範囲の特定
   - 緊急パッチの適用

2. **短期対応**:
   - 代替パッケージの検討
   - セキュリティテストの実施
   - デプロイ

**責任者**: セキュリティエンジニア

---

## 5. 運用リスク

### 5.1 本番データの消失

**リスク内容**:
誤操作や障害により、本番環境のデータが消失し、ビジネスに重大な影響を与える。

**発生確率**: **低** (20%未満)
**影響度**: **高** (致命的)
**リスクスコア**: **3** (高)

**発生シナリオ**:
- 誤ったFirestoreクエリによる大量削除
- バグによるデータ破損
- マルウェアやランサムウェア攻撃

**予防策**:
1. ✅ **実装済**: Firestoreの自動バックアップ（Point-in-Time Recovery）
2. **推奨**: 本番データへのアクセス制限
3. **推奨**: 削除操作の承認フロー
4. **推奨**: データ復元手順の文書化
5. **推奨**: 定期的な復元テスト（四半期ごと）

**発生時の対応策**:
1. **即時対応（10分以内）**:
   - データ消失の確認
   - サービスの一時停止（必要に応じて）
   - インシデント報告

2. **緊急復旧（1時間以内）**:
   - バックアップからの復元
   - データ整合性の確認
   - サービスの再開

3. **事後対応**:
   - 根本原因分析
   - 再発防止策の実施
   - インシデントレポートの作成

**責任者**: インフラエンジニア、セキュリティ責任者

**RPO/RTO**:
- RPO (Recovery Point Objective): 1時間
- RTO (Recovery Time Objective): 2時間

---

### 5.2 不正アクセス・セキュリティ侵害

**リスク内容**:
不正アクセスやセキュリティ侵害により、機密データが漏洩または改ざんされる。

**発生確率**: **低** (20%未満)
**影響度**: **高** (致命的)
**リスクスコア**: **3** (高)

**発生シナリオ**:
- 認証情報の漏洩
- SQLインジェクションやXSS攻撃
- 内部関係者による不正アクセス

**予防策**:
1. ✅ **実装済**: Firebase Authenticationによる認証
2. ✅ **実装済**: Firestore Security Rulesによる認可
3. **実施中**: 入力値バリデーション
4. **推奨**: 定期的なセキュリティ監査（年2回）
5. **推奨**: ペネトレーションテストの実施
6. **推奨**: セキュリティログの監視
7. **推奨**: 多要素認証（MFA）の強制

**発生時の対応策**:
1. **即時対応（30分以内）**:
   - インシデント検知
   - 影響範囲の特定
   - アカウントのロック

2. **緊急対応（2時間以内）**:
   - 脆弱性の修正
   - 侵入経路の遮断
   - 関係者への通知

3. **事後対応**:
   - フォレンジック調査
   - 影響を受けたユーザーへの通知
   - 監督官庁への報告（必要に応じて）
   - 再発防止策の実施

**責任者**: セキュリティ責任者、CISO

---

### 5.3 ユーザーの誤操作によるデータ損失

**リスク内容**:
ユーザーが誤って重要なデータ（ナレッジ、チャット履歴）を削除し、復元できない。

**発生確率**: **中** (20-49%)
**影響度**: **中** (重大)
**リスクスコア**: **4** (高)

**発生シナリオ**:
- 削除ボタンの誤クリック
- 一括削除操作のミス
- 理解不足による誤操作

**予防策**:
1. **推奨**: 削除前の確認ダイアログ
2. **推奨**: ソフトデリート（論理削除）の実装
3. **推奨**: ゴミ箱機能（30日間保持）
4. **推奨**: 重要操作のログ記録
5. **推奨**: ユーザートレーニングの実施

**発生時の対応策**:
1. ゴミ箱からの復元
2. バックアップからの復元（管理者）
3. ユーザーへの再教育

**責任者**: プロダクトマネージャー

---

### 5.4 Cloud Functionsのデプロイ失敗

**リスク内容**:
Cloud Functionsのデプロイが失敗し、サービスが一時的に利用できなくなる。

**発生確率**: **低** (20%未満)
**影響度**: **中** (重大)
**リスクスコア**: **2** (中)

**発生シナリオ**:
- 環境変数の設定ミス
- 依存関係の問題
- デプロイスクリプトのバグ

**予防策**:
1. **実施中**: CI/CDパイプラインでの自動テスト
2. **推奨**: ステージング環境での事前検証
3. **推奨**: Blue-Greenデプロイメントの採用
4. **推奨**: ロールバック手順の文書化
5. **推奨**: デプロイ前のチェックリスト

**発生時の対応策**:
1. エラーログの確認
2. 即座のロールバック
3. 修正と再デプロイ

**責任者**: DevOpsエンジニア

---

### 5.5 監視・アラート設定の不備

**リスク内容**:
監視やアラート設定が不十分で、障害やパフォーマンス劣化を早期に検知できない。

**発生確率**: **中** (20-49%)
**影響度**: **中** (重大)
**リスクスコア**: **4** (高)

**発生シナリオ**:
- アラート閾値の設定ミス
- 監視対象の漏れ
- アラート疲れによる見逃し

**予防策**:
1. ✅ **実装済**: コスト監視とアラート
2. ✅ **実装済**: ヘルスチェックシステム
3. **推奨**: 包括的な監視ダッシュボード
4. **推奨**: SLO/SLIの定義
5. **推奨**: アラートの優先度設定
6. **推奨**: オンコール体制の整備

**発生時の対応策**:
1. 監視設定の見直し
2. 適切な閾値の設定
3. アラート通知先の最適化

**責任者**: SREエンジニア

---

## リスクマトリックス

以下は、全リスクを発生確率と影響度で可視化したマトリックスです。

```
影響度
  高 │ [1.1] [1.2] [2.3] [4.1] [4.2] [4.3] [4.5] [5.1] [5.2]
     │   Claude  Voyage  パフォ  価格  仕様   規制  npm  データ セキュ
     │   レート  API    -マンス 変動  変更   変更  脆弱  消失  リティ
     │                                           性
  中 │ [1.3] [1.5] [2.1] [2.2] [3.2] [3.3] [4.4] [5.3] [5.4] [5.5]
     │ Firestore Bundle 機能  仕様  スキル コミュ Firebase ユーザ デプロイ 監視
     │ パフォ   サイズ  追加  変更  不足  不足  価格  誤操作 失敗  不備
  低 │ [1.4] [3.1]
     │ コールド キー
     │ スタート パーソン
     │         離脱
     ├─────────────────────────────────────────────→
       低          中                    高        発生確率
```

### リスク分布サマリー

| 優先度 | スコア範囲 | リスク数 |
|--------|-----------|---------|
| 最優先 | 6-9 | 6件 |
| 高 | 3-5 | 13件 |
| 中 | 1-2 | 3件 |

---

## 緊急対応プラン

### インシデント対応体制

```
┌─────────────────────────────────────────────────────────┐
│             インシデント発生                              │
└─────────────┬───────────────────────────────────────────┘
              │
              ▼
┌─────────────────────────────────────────────────────────┐
│ レベル1: オンコールエンジニア（5分以内に対応）             │
│  - 初期診断                                              │
│  - ログ確認                                              │
│  - 一次対応（再起動、スケールアップなど）                  │
└─────────────┬───────────────────────────────────────────┘
              │ エスカレーション（15分以内）
              ▼
┌─────────────────────────────────────────────────────────┐
│ レベル2: テックリード・SREリーダー                        │
│  - 詳細分析                                              │
│  - 対応方針の決定                                        │
│  - チーム招集                                            │
└─────────────┬───────────────────────────────────────────┘
              │ エスカレーション（30分以内、重大インシデント時）
              ▼
┌─────────────────────────────────────────────────────────┐
│ レベル3: プロジェクトマネージャー・CTO                     │
│  - 経営判断                                              │
│  - ステークホルダー通知                                   │
│  - 外部リソース調達                                      │
└─────────────────────────────────────────────────────────┘
```

### 重大度分類

| レベル | 定義 | 対応時間 | 通知先 |
|--------|------|---------|--------|
| **P0 - Critical** | サービス全停止、データ消失 | 5分以内 | 全員 + 経営層 |
| **P1 - High** | 主要機能の停止、重大なパフォーマンス劣化 | 15分以内 | 技術チーム + PM |
| **P2 - Medium** | 一部機能の停止、軽微なパフォーマンス劣化 | 1時間以内 | 技術チーム |
| **P3 - Low** | UI の不具合、非重要機能の問題 | 翌営業日 | 担当エンジニア |

### インシデント対応フロー

1. **検知** (0-5分)
   - 監視アラート
   - ユーザー報告
   - 定期ヘルスチェック

2. **初期対応** (5-15分)
   - インシデント報告（Slack #incidents チャンネル）
   - 重大度の判定
   - ステータスページの更新

3. **調査・対応** (15分-2時間)
   - 根本原因の特定
   - 暫定対応の実施
   - 進捗の定期報告（30分ごと）

4. **復旧** (2-4時間)
   - 恒久対応の実施
   - サービスの復旧確認
   - ステータスページの更新

5. **事後対応** (翌営業日)
   - ポストモーテムの作成
   - 再発防止策の策定
   - ドキュメントの更新

### エスカレーション連絡先

| 役割 | 名前 | 連絡先 | 対応時間 |
|------|------|--------|---------|
| オンコールエンジニア | [TBD] | [Phone/Slack] | 24/7 |
| テックリード | [TBD] | [Phone/Slack] | 平日9-21時 |
| SREリーダー | [TBD] | [Phone/Slack] | 平日9-21時 |
| プロジェクトマネージャー | [TBD] | [Phone/Email] | 平日9-18時 |
| CTO | [TBD] | [Phone/Email] | 平日9-18時 |

---

## 月次リスクレビュー手順

### 目的

定期的にリスクの状況を見直し、新たなリスクの特定と既存リスクの更新を行う。

### スケジュール

- **頻度**: 月次（毎月第1金曜日）
- **時間**: 14:00-16:00 (2時間)
- **場所**: 会議室 or オンライン

### 参加者

- **必須**:
  - プロジェクトマネージャー（ファシリテーター）
  - テックリード
  - インフラエンジニア
  - セキュリティエンジニア

- **任意**:
  - プロダクトマネージャー
  - フロントエンド/バックエンド代表者
  - ステークホルダー

### アジェンダ（120分）

#### 1. 前回のアクションアイテム確認 (15分)

- 前月のアクションアイテムの完了状況レビュー
- 未完了項目の理由確認と再スケジュール

#### 2. 既存リスクのステータス更新 (30分)

各カテゴリーのリスクについて以下を確認：

**確認項目**:
- 発生確率の変化（高/中/低）
- 影響度の変化（高/中/低）
- 予防策の実施状況
- モニタリング指標の確認

**更新が必要な項目**:
- リスクスコアの再計算
- 対策の有効性評価
- 責任者の変更

#### 3. 新規リスクの識別 (20分)

以下の観点から新規リスクを議論：

- **技術環境の変化**:
  - 新しい依存ライブラリの追加
  - インフラ構成の変更
  - 新機能の実装

- **外部環境の変化**:
  - 外部サービスのアナウンスメント
  - 法規制の動向
  - 市場トレンド

- **プロジェクトの変化**:
  - チーム構成の変更
  - スコープの変更
  - 予算の変更

#### 4. インシデント・問題のレビュー (15分)

前月発生したインシデントや問題を振り返り：

- インシデントの根本原因
- 対応の適切性
- 予防できたか
- 新たなリスクとして追加すべきか

#### 5. モニタリング指標のレビュー (20分)

主要なKPIとメトリクスを確認：

**技術指標**:
- API使用率（RPM/TPM）
- エラー率
- レスポンス時間
- Cloud Functionsのパフォーマンス

**コスト指標**:
- 月間API費用
- Firebase費用
- 予算使用率

**品質指標**:
- バグ数
- セキュリティ脆弱性
- テストカバレッジ

#### 6. リスク対応計画の更新 (15分)

- 優先度の再評価
- 新たな予防策の検討
- 責任者とデッドラインの設定

#### 7. アクションアイテムの決定 (5分)

- 次月までに実施する対策のリスト化
- 担当者とデッドラインの明確化
- 進捗報告方法の確認

### 成果物

レビュー後、以下のドキュメントを更新：

1. **リスク管理計画書** (本ドキュメント)
   - リスクリストの更新
   - リスクマトリックスの更新

2. **月次リスクレビューレポート**
   - レビュー日時と参加者
   - 更新されたリスクのサマリー
   - 新規リスク
   - アクションアイテム
   - 次回レビュー予定

3. **アクションアイテムトラッカー**
   - タスク内容
   - 担当者
   - デッドライン
   - ステータス

### レポートテンプレート

```markdown
# 月次リスクレビューレポート

**レビュー日**: YYYY年MM月DD日
**参加者**: [名前リスト]
**ファシリテーター**: [名前]

## サマリー

- 総リスク数: XX件
- 新規リスク: X件
- クローズしたリスク: X件
- 最優先リスク: X件

## 主要な変更

### 発生確率・影響度が変更されたリスク

| リスクID | リスク名 | 変更前 | 変更後 | 理由 |
|---------|---------|--------|--------|------|
| 1.1 | ... | 高×高 | 中×高 | キューイング実装により軽減 |

### 新規リスク

| リスクID | リスク名 | 確率 | 影響 | スコア |
|---------|---------|------|------|--------|
| X.X | ... | 中 | 高 | 6 |

### クローズしたリスク

| リスクID | リスク名 | クローズ理由 |
|---------|---------|-------------|
| X.X | ... | 対策完了、発生可能性がゼロに |

## インシデントレビュー

### 前月のインシデント

1. **[P2] Cloud Functionsタイムアウト増加** (MM/DD)
   - 原因: 大量のバッチ処理
   - 対応: バッチサイズの調整
   - 新規リスク: なし

## モニタリング指標

### API使用率

- Claude API RPM: XX% (前月比 +X%)
- Voyage AI RPM: XX% (前月比 +X%)

### コスト

- 月間API費用: $XXX (予算 $XXX)
- Firebase費用: $XXX (予算 $XXX)

### パフォーマンス

- P95レスポンス時間: XXXms (目標 <500ms)
- エラー率: X.X% (目標 <1%)

## アクションアイテム

| # | アクション | 担当者 | デッドライン | ステータス |
|---|-----------|--------|-------------|-----------|
| 1 | ... | [名前] | YYYY/MM/DD | 🔵 進行中 |
| 2 | ... | [名前] | YYYY/MM/DD | ⚪ 未着手 |

## 次回レビュー

- **日時**: YYYY年MM月DD日 14:00-16:00
- **重点テーマ**: [特に注目すべきリスク領域]
```

### 成功の指標

月次リスクレビューの有効性は以下で評価：

1. **参加率**: 必須参加者の出席率 >90%
2. **リスク特定率**: 新規リスクの月次特定数 >2件
3. **対策実施率**: アクションアイテムの完了率 >80%
4. **インシデント削減**: リスク管理により防げたインシデント数

---

## 付録

### A. リスク管理用語集

| 用語 | 定義 |
|------|------|
| **リスク** | プロジェクトの目標達成を脅かす不確実な事象 |
| **発生確率** | リスクが現実化する可能性（高/中/低） |
| **影響度** | リスクが発生した場合の被害の大きさ（高/中/低） |
| **リスクスコア** | 発生確率と影響度を掛け合わせた値（1-9） |
| **予防策** | リスクの発生を防ぐための事前対策 |
| **対応策** | リスクが発生した場合の対処方法 |
| **リスクオーナー** | リスク管理の最終責任者 |
| **エスカレーション** | 上位の意思決定者への報告と判断依頼 |

### B. リスク管理ツール

| ツール | 用途 | URL |
|--------|------|-----|
| Google Sheets | リスクトラッカー | [TBD] |
| Slack #risks | リスク議論チャンネル | [TBD] |
| Jira | アクションアイテム管理 | [TBD] |
| Cloud Monitoring | 技術メトリクス監視 | [TBD] |

### C. 参考資料

- [ET-AI アーキテクチャ設計書](./BATCH_PROCESSING_ARCHITECTURE.md)
- [Firebase セキュリティルール](./firestore.rules)
- [インシデント対応手順書](./INCIDENT_RESPONSE.md) [TBD]
- [ビジネス継続計画](./BUSINESS_CONTINUITY_PLAN.md) [TBD]

### D. バージョン履歴

| バージョン | 日付 | 変更内容 | 承認者 |
|-----------|------|---------|--------|
| 1.0 | 2025/11 | 初版作成 | [TBD] |

---

## 承認

本リスク管理計画は、以下の承認を得て発効します。

| 役職 | 名前 | 署名 | 日付 |
|------|------|------|------|
| プロジェクトマネージャー | [TBD] | | |
| テックリード | [TBD] | | |
| セキュリティ責任者 | [TBD] | | |
| CTO | [TBD] | | |

---

**次回レビュー予定**: 2025年12月（第1金曜日）
